---
layout:     post
title:      "[Compiler] Syntax Analysis"
toc:        true
categories: [Compiler]
---
## 1. The Role of Parser
Lexer的职责是将"A stream of characters"转化成为"A stream of tokens"，Parser是Lexer的后级，负责赋予
"A stream of tokens"以语法结构，通常为Parse Tree，然后将Parse Tree交给Compiler Front End的剩余部分处理。

一共有三种类型的Parser：**universal**, **top-down**, **bottom-up**。universal类型的Parser可以解析任何
grammar，但是效率不高；top-down parser自顶(root)向下(leaves)构建Parse Tree，bottom-up parser自底
(leaves)向上(root)构建Parse Tree，二者只能处理grammar的子集，但是对于现代编程语言来说已经足够描述语法结构了。


## 2. Context-Free Grammar
Grammar用来描述Language的Syntax，Syntax更抽象，Grammar更具体，在Compiler系列文章的Parser上下文中有时会混用
二者。这里介绍一种常见的Grammar：**Context-Free Grammar**。

### 2.1 Definition of Context-Free Grammar
A Context-Free Grammar consists of **terminials**, **nonterminals**, a **start symbol** and **productions**.
#### Terminals
> **Terminals** are the basic symbols from which strings are formed. The term
> **token name** is a synonym for terminal and frequently we will use the
> word **token** for terminal when it is clear that we are talking about just
> the token name.

#### Nonterminals
> **Nonterminals** are **syntactic variables** that denote sets of strings. 
> Nonterminals impose a hierarchical structure on the language that is key to syntax
> analysis and translation.

#### Start Symbol
> In a grammar, one **nonterminal** is distinguished as the **start symbol**, and
> the set of strings it denotes is the language generated by the grammar.
> Conventionally, the **productions** for the start symbol are listed rst.

#### Productions
> The **productions** of a grammar specify the manner in which the **terminals** 
> and **nonterminals** can be combined to form strings. Each production
> consists of:
> 1. A nonterminal called the head or left side of the production; this
> production defines some of the strings denoted by the head.
> 2. The symbol $$\rightarrow$$ Sometimes $$::=$$ has been used in place of the arrow.
> 3. A body or right side consisting of zero or more terminals and nonterminals.
> The components of the body describe one way in which
> strings of the nonterminal at the head can be constructed.

下面看两个例子：

##### [例1] the grammar defines *if-else statements*
这个grammar定义了一个*if-else statement*。

* start symbol为$$stmt$$；
* $$stmt$$和$$expr$$为nonterminals；
* $$\boldsymbol{if}$$和$$\boldsymbol{else}$$作为keyword是terminals。

$$
\begin{aligned}
stmt\ &\rightarrow\ \boldsymbol{if}\ (expr)\ \ stmt\ \ \boldsymbol{else}\ \ stmt \\
expr\ &\rightarrow\ ...
\end{aligned}
$$

##### [例2]  the grammar defines simple arithmetic expressions:
这个grammar定义了简单的数学运算表达式。

* start symbol为$$expression$$；
* $$expression$$、$$term$$和$$factor$$为nonterminals；
* $$\boldsymbol{id}$$、operator $$+$$、$$-$$、$$*$$和$$/$$为terminals。

$$
\begin{aligned}
expression\ &\rightarrow\ expression\ + \ term  \\
expression\ &\rightarrow\ expression\ - \ term  \\
expression\ &\rightarrow\ term                  \\
term\ &\rightarrow\ term\ *\ factor             \\
term\ &\rightarrow\ term\ /\ factor             \\
term\ &\rightarrow\ factor                      \\
factor\ &\rightarrow\ (\ expression\ )          \\
factor\ &\rightarrow\ \boldsymbol{id}           \\


\end{aligned}
$$

## Syntax Error Handling and Recovery Strategies